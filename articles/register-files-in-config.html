<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register files in config • fusen</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Bootstrap --><link href="../cosmo.css" rel="stylesheet">
<link href="../thinkr.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Register files in config">
<meta property="og:description" content="fusen">
<meta property="og:image" content="https://thinkr-open.github.io/fusen/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!--  Code folding --><script src="../codefolding.js"></script><link href="../codefolding.css" rel="stylesheet">
<!--
<script>
         document.write('<div class="navbar"><div class="container"><div id="code-folding-buttons" class="btn-group"><button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-_extension-text-contrast=""><span>Show/Hide all code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div></div></div>')
</script>
--><!-- google analytics
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-115082821-1');
</script>
-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fusen</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/How-to-use-fusen.html">How to use fusen</a>
    </li>
    <li>
      <a href="../articles/Maintain-packages-with-fusen.html">Maintain packages with {fusen}</a>
    </li>
    <li>
      <a href="../articles/inflate-all-your-flat-files.html">Inflate all your flat files</a>
    </li>
    <li>
      <a href="../articles/register-files-in-config.html">Register files in config</a>
    </li>
    <li>
      <a href="../articles/share-on-a-github-website.html">Share on a GitHub website</a>
    </li>
    <li>
      <a href="../articles/tips-and-tricks.html">Tips and tricks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
          <div id="code-folding-buttons" class="btn-group">
<button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-_extension-text-contrast=""><span>Show/Hide all code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>
        </li>
        <li>
  <a href="https://github.com/Thinkr-open/fusen/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Register files in config</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Thinkr-open/fusen/blob/HEAD/vignettes/register-files-in-config.Rmd" class="external-link"><code>vignettes/register-files-in-config.Rmd</code></a></small>
      <div class="hidden name"><code>register-files-in-config.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://thinkr-open.github.io/fusen/">fusen</a></span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/flat_register_config_file.Rmd: do not edit by hand -->
<div class="section level2">
<h2 id="fusen-registers-all-files-of-your-package">{fusen} registers all files of your package<a class="anchor" aria-label="anchor" href="#fusen-registers-all-files-of-your-package"></a>
</h2>
<p>From {fusen} &gt;=0.5, a file named “dev/config_fusen.yaml” (by
default) registers all files created from a specific “flat” file as soon
as you inflate it. This helps you keep track on the link between flat
files and all R, tests and vignettes files created in your package.</p>
<p>This configuration file also register all files not created from a
flat file. This helps you keep your package clean.</p>
<!--
To make this work properly, you will have to register all files that were not created from a flat file. `add_files_to_config()` will help you do so (See below: "Register some specific files, even with regex").  
-->
<p>To know if you have some special steps to realize with this version
of {fusen}, run:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fusen</span><span class="fu">::</span><span class="fu"><a href="../reference/inflate_all.html">inflate_all_no_check</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Messages of this function will guide you through the transition if
you used a too old version of {fusen}.</p>
<p>Chances are that you will need to:</p>
<ol style="list-style-type: decimal">
<li>Inflate each flat file of your project one by one (at least once)
with this version of {fusen}</li>
<li>Run <code><a href="../reference/check_not_registered_files.html">fusen::check_not_registered_files()</a></code>
</li>
<li>Check the content of “dev/config_not_registered.csv” if there are
unregistered files.</li>
<li>Clean up your package of useless unregistered files if
required.</li>
<li>Register all remaining unregistered files with
<code><a href="../reference/register_all_to_config.html">fusen::register_all_to_config()</a></code>
</li>
</ol>
<p>Try again <code><a href="../reference/inflate_all.html">fusen::inflate_all_no_check()</a></code> or
<code><a href="../reference/inflate_all.html">fusen::inflate_all()</a></code> and that should be good now.<br><em>Read
<code><a href="../articles/inflate-all-your-flat-files.html">vignette("inflate-all-your-flat-files", package = "fusen")</a></code>
to know more about <code><a href="../reference/inflate_all.html">inflate_all()</a></code>.</em></p>
<!--

### Register some specific files, even with regex

TODO?

You may not want to register each new file that does not come during an inflate process. For instance, with {golem}, there are module (`^mod_*`) files, which need to be protected. You can add this regular expression directly in the yaml file with `add_files_to_config(c("R" = "^mod_*"))` 
-->
</div>
<div class="section level2">
<h2 id="what-is-the-configuration-file">What is the configuration file?<a class="anchor" aria-label="anchor" href="#what-is-the-configuration-file"></a>
</h2>
<p>The configuration file is stored as “dev/config_fusen.yaml”.<br>
This lists all flat files that were inflated, along with the lists of
all files created during inflate and the parameters used to
inflate.<br>
This also list all other files, not created with the flat files, under a
section named “keep”.</p>
<p>For instance, a part of the configuration file of package {fusen}
looks like:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">flat_addins.Rmd</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">path</span><span class="kw">:</span><span class="at"> dev/flat_addins.Rmd</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">state</span><span class="kw">:</span><span class="at"> active</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">R</span><span class="kw">:</span><span class="at"> R/build_fusen_chunks.R</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">tests</span><span class="kw">:</span><span class="at"> tests/testthat/test-build_fusen_chunks.R</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">vignettes</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">inflate</span><span class="kw">:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">flat_file</span><span class="kw">:</span><span class="at"> dev/flat_addins.Rmd</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">vignette_name</span><span class="kw">:</span><span class="at"> .na</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">open_vignette</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">check</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">document</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">overwrite</span><span class="kw">:</span><span class="at"> ask</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">keep</span><span class="kw">:</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">path</span><span class="kw">:</span><span class="at"> keep</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">R</span><span class="kw">:</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> R/addins.R</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> R/create_fusen_rsproject.R</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> R/fusen-package.R</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> R/globals.R</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> R/inflate-utils.R</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> R/load_flat_functions.R</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> R/utils-pipe.R</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">tests</span><span class="kw">:</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> tests/testthat/test-create_fusen_rsproject.R</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> tests/testthat/test-inflate_qmd.R</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> tests/testthat/test-inflate_utils.R</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> tests/testthat/test-load_flat_functions.R</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> tests/testthat/test-skeleton.R</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">vignettes</span><span class="kw">:</span><span class="at"> vignettes/tips-and-tricks.Rmd</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-about-unregistered-files">What about unregistered files?<a class="anchor" aria-label="anchor" href="#what-about-unregistered-files"></a>
</h2>
<p>Imagine you inflated some function named <code>my_fun()</code>, and
then you decide to change the name of the function to
<code>my_new_fun()</code>. After inflate, there will be two files
“R/myfun.R” and “R/my_new_fun.R” in your package. However, “R/myfun.R”
should be deleted because this function should not exist anymore.</p>
<p>If you are unsure about which files should still be there or not, you
can run <code><a href="../reference/check_not_registered_files.html">fusen::check_not_registered_files()</a></code>. In this case,
“R/myfun.R” will appear in the csv file created in
“dev/config_not_registered.csv”, with a message like “Possibly
deprecated file”.</p>
<p>You now have the possibility to detect deprecated files of your
project.<br>
Run <code><a href="../reference/check_not_registered_files.html">fusen::check_not_registered_files()</a></code> as often as you
need if you want to clean your project. <em>Note that this function is
included in <code><a href="../reference/inflate_all.html">fusen::inflate_all()</a></code> and
<code><a href="../reference/inflate_all.html">fusen::inflate_all_no_check()</a></code>, which let you the
opportunity to clean your project regularly.</em></p>
<p>To be able to detect deprecated files, all legitimate files need to
be registered. Even the ones that you created manually. In this case,
they will be listed under the <code>"keep"</code> section. {fusen} knows
that it should not bother you with these files.</p>
</div>
<div class="section level2">
<h2 id="deprecate-flat-files-after-inflate">Deprecate flat files after inflate<a class="anchor" aria-label="anchor" href="#deprecate-flat-files-after-inflate"></a>
</h2>
<p>In the example configuration file above, you can note that the
“flat_addins.Rmd” section has a parameter <code>state: active</code>
which means that <code><a href="../reference/inflate_all.html">inflate_all()</a></code> will indeed inflate this
file.</p>
<p>If your practice of {fusen} is to inflate it once, and then continue
development in the R, test and vignette files directly, then you may
want to properly deprecated the flat file.</p>
<p>In this case, we recommend to store your flat file in a sub-directory
named “dev/dev_history/” as this will be the default behavior in a
future release. Then, you can change your flat file to
<code>state: deprecated</code> in the configuration file, and change
both <code>path:</code> section of the file too.</p>
</div>
<div class="section level2">
<h2 id="detect-all-files-that-are-not-registered-in-configuration-file">Detect all files that are not registered in configuration file<a class="anchor" aria-label="anchor" href="#detect-all-files-that-are-not-registered-in-configuration-file"></a>
</h2>
<p><code><a href="../reference/check_not_registered_files.html">check_not_registered_files()</a></code> shows files that are not
already registered in the yaml config file.<br><em>Note that <code><a href="../reference/check_not_registered_files.html">check_not_registered_files()</a></code> will try to
guess the source flat template, if you used {fusen} &gt;= 0.4
before.</em></p>
<p>The csv file “dev/config_not_registered.csv” created by
<code><a href="../reference/check_not_registered_files.html">check_not_registered_files()</a></code> lists all unregistered files.
It contains three columns:</p>
<ul>
<li>type: The type of file among R, test or vignette</li>
<li>path: The path where to find the unregistered file</li>
<li>origin: If the file was created from a former flat file, the origin
may be detected.
<ul>
<li>If the flat file detected already appears in the configuration file,
the unregistered file is probably a deprecated file that needs to be
deleted. But only you know.</li>
<li>If the flat file detected is not already in the configuration file,
the section for this flat file will be created during the next step with
<code><a href="../reference/register_all_to_config.html">register_all_to_config()</a></code>.</li>
<li>If no source was detected, this probably means that you created it
manually.</li>
</ul>
</li>
</ul>
<p>Decide which files you want to delete. Then run
<code><a href="../reference/register_all_to_config.html">fusen::register_all_to_config()</a></code> to register all remaining
files in the “keep” section.</p>
<p>Have a look at the configuration file at the end of the process to
check that everything is set properly. Maybe some flat files detected
should not be in <code>state: active</code> but in
<code>state: deprecated</code>. You’re the only one who knows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' \dontrun{</span></span>
<span><span class="co"># Run this on the current package in development</span></span>
<span><span class="va">out_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_not_registered_files.html">check_not_registered_files</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/file.edit.html" class="external-link">file.edit</a></span><span class="op">(</span><span class="va">out_csv</span><span class="op">)</span></span>
<span><span class="co">#' }</span></span></code></pre></div>
<!-- Use eval=FALSE because inflate cannot work inside a Rmd vignette -->
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or you can try on the reproducible example</span></span>
<span><span class="va">dummypackage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"clean"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dummypackage</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># {fusen} steps</span></span>
<span><span class="fu"><a href="../reference/fill_description.html">fill_description</a></span><span class="op">(</span>pkg <span class="op">=</span> <span class="va">dummypackage</span>, fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Title <span class="op">=</span> <span class="st">"Dummy Package"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dev_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/add_flat_template.html">add_flat_template</a></span><span class="op">(</span>pkg <span class="op">=</span> <span class="va">dummypackage</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span>, open <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flat_file</span> <span class="op">&lt;-</span> <span class="va">dev_file</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"flat_"</span>, <span class="va">dev_file</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Inflate once</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/proj_utils.html" class="external-link">with_project</a></span><span class="op">(</span><span class="va">dummypackage</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/inflate.html">inflate</a></span><span class="op">(</span></span>
<span>      pkg <span class="op">=</span> <span class="va">dummypackage</span>, flat_file <span class="op">=</span> <span class="va">flat_file</span>,</span>
<span>      vignette_name <span class="op">=</span> <span class="st">"Get started"</span>, check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      open_vignette <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Add a not registered file to the package</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"# test R file\n"</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dummypackage</span>, <span class="st">"R"</span>, <span class="st">"to_keep.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Use the function to check the list of files</span></span>
<span>  <span class="va">out_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_not_registered_files.html">check_not_registered_files</a></span><span class="op">(</span><span class="va">dummypackage</span><span class="op">)</span></span>
<span>  <span class="va">out_csv</span></span>
<span>  <span class="co"># Read the csv to see what is going on</span></span>
<span>  <span class="va">content_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">out_csv</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">content_csv</span></span>
<span>  <span class="co"># Keep it all or delete some files, and then register all remaining</span></span>
<span>  <span class="va">out_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_all_to_config.html">register_all_to_config</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">out_config</span></span>
<span>  <span class="co"># Open the out_config file to see what's going on</span></span>
<span>  <span class="fu">yaml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yaml/man/read_yaml.html" class="external-link">read_yaml</a></span><span class="op">(</span><span class="va">out_config</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">dummypackage</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-register_all_to_config-works">How <code>register_all_to_config()</code> works<a class="anchor" aria-label="anchor" href="#how-register_all_to_config-works"></a>
</h2>
<p>If all files of the current state are legitimate, then, you can
register everything in the config file.</p>
<p>Run <code><a href="../reference/register_all_to_config.html">register_all_to_config()</a></code> in your current package to
create the “dev/config_fusen.yaml” that registers all your files. You
will note a “keep” section, which lists all files for which the source
was not guessed.</p>
<p>This function deletes the “config_not_registered.csv” created with
<code><a href="../reference/check_not_registered_files.html">check_not_registered_files()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' \dontrun{</span></span>
<span><span class="co"># Usually run this one inside the current project</span></span>
<span><span class="co"># Note: running this will write "dev/config_fusen.yaml" in your working directory</span></span>
<span><span class="fu"><a href="../reference/register_all_to_config.html">register_all_to_config</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#' }</span></span></code></pre></div>
<!-- Use eval=FALSE because inflate cannot work inside a Rmd vignette -->
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or you can try on the reproducible example</span></span>
<span><span class="va">dummypackage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"register"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dummypackage</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># {fusen} steps</span></span>
<span><span class="fu"><a href="../reference/fill_description.html">fill_description</a></span><span class="op">(</span>pkg <span class="op">=</span> <span class="va">dummypackage</span>, fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Title <span class="op">=</span> <span class="st">"Dummy Package"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dev_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/add_flat_template.html">add_flat_template</a></span><span class="op">(</span>pkg <span class="op">=</span> <span class="va">dummypackage</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span>, open <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flat_file</span> <span class="op">&lt;-</span> <span class="va">dev_file</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"flat_"</span>, <span class="va">dev_file</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Inflate once</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/proj_utils.html" class="external-link">with_project</a></span><span class="op">(</span><span class="va">dummypackage</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/inflate.html">inflate</a></span><span class="op">(</span></span>
<span>      pkg <span class="op">=</span> <span class="va">dummypackage</span>, flat_file <span class="op">=</span> <span class="va">flat_file</span>,</span>
<span>      vignette_name <span class="op">=</span> <span class="st">"Get started"</span>, check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      open_vignette <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">out_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/register_all_to_config.html">register_all_to_config</a></span><span class="op">(</span><span class="va">dummypackage</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Look at the output</span></span>
<span>  <span class="fu">yaml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yaml/man/read_yaml.html" class="external-link">read_yaml</a></span><span class="op">(</span><span class="va">out_path</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<!-- ### Protect existing R, tests and vignettes files -->
<!-- `df_to_config()` allows to add your own list of files that you want to `keep` in your package, despite not being created with a flat file.   -->
<!-- This is important if you started to develop without {fusen}, and start using a flat file from now on, so that {fusen} does not delete your existing files. -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="thinkr">
  <p></p>
<p>Developed by Sebastien Rochette.</p>,<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

<div class="author">
  <p>
    Developed by .
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
